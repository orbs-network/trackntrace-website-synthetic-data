{"version":3,"sources":["serviceWorker.ts","names.ts","record.ts","record-store.ts","statistics.ts","gateway-config.ts","osa-alerts.ts","alerts.ts","shrinkage-alerts.ts","resources.ts","page-header.tsx","item-status-page.tsx","bar-chart.tsx","alerts-table.tsx","overview-page.tsx","osa-stats.ts","error-page.tsx","on-shelf-availability-page.tsx","routes.ts","shrinkage-page.tsx","side-menu.tsx","loading-page.tsx","App.tsx","index.tsx","stores.ts"],"names":["Boolean","window","location","hostname","match","names","hashCode","s","Math","abs","split","reduce","a","b","charCodeAt","ScanRecord","raw","gatewayConfig","rawLowecase","this","Object","keys","forEach","k","toLowerCase","tagid","timestampInMilliseconds","timestamp","Date","gatewayid","eventtype","eventvalue","cfg","getFor","Alias","LocationCategory","JSON","stringify","toString","h","recordId","lastName","length","RecordStore","pollingIntervalMs","init","now","fetch","setTimeout","ready","f","err","process","res","json","records","filter","r","msg","map","find","x","_","observable","Statistics","recordsStore","item","itemRecords","timestampInSeconds","itemId","_itemRecords","gatewayId","_itemCountByGateway","groupBy","values","pRecs","mean","value","avgPiplineTimePerItemInSeconds","mapValues","recs","n","max","uniq","rec","push","latestRecordsPerItem","tooManyScansAlerts","alerts","itemUIDs","uid","itemRecordsSortedByTime","timestampAsDate","category","alertType","count","computed","LocationCategories","findLocationCategory","cat","replace","loadGatewayConfigRecords","url","stripKey","strip","trim","Promise","resolve","reject","Papa","download","header","error","complete","results","data","newK","ID","id","alias","locationcategory","SiteCategory","sitecategory","BackroomGatewayId","backroomgatewayid","GatewayConfig","configById","prevalidateConfig","postvalidateConfig","Error","all","c","OSAAlerts","statistics","customerRetailShelves","shelf","backroom","onShelf","itemCountByGateway","customerBackrooms","inventoryNotOnShelfAlerts","concat","backroomInventoryLowAlerts","alertsByTime","nBins","minBinSize","bins","binSize","startTime","times","getTime","floor","alertsInLast","duration","ShrinkageAlerts","FrontDoors","frontDoor","pos","itemID","posRec","frontDoorRec","shelfRec","y","shelfRecs","gatewayLocationCategory","lastShelfRec","itemWentDarkAlerts","alert","LARGE_QTY_WENT_DARK_THRESHOLD","quantity","itemSkippedPOSAlerts","largeQuantityWentDarkAlerts","gatewayImage","PageHeader","title","style","height","borderBottom","fontWeight","display","alignItems","paddingLeft","twodigits","ItemStatusPage","inject","observer","currentTimeoutHandle","loadData","reaction","selected","clearTimeout","props","margin","fontSize","padding","Autocomplete","options","getOptionLabel","option","width","filterOptions","createFilterOptions","matchFrom","onChange","e","selectedItemUID","renderInput","params","TextField","label","variant","CircularProgress","marginLeft","borderRadius","border","backgroundColor","flexDirection","marginRight","overflow","color","letterSpacing","paddingBottom","className","itemPipelineTimeInSeconds","slice","pageSize","currentPage","textAlign","verticalAlign","backgroundImage","backgroundSize","backgroundRepeat","whiteSpace","backgroundPosition","gatewayAlias","eventType","eventValue","getDate","toLocaleString","month","getFullYear","getHours","getMinutes","TablePagination","rowsPerPageOptions","component","rowsPerPage","page","onChangePage","onChangeRowsPerPage","parseInt","target","isOperatorDialogOpen","Dialog","onClose","closeOperatorDialog","aria-labelledby","open","DialogContent","scanRecordForOperatorRetreival","retrievingDetails","operatorDetails","Button","onClick","retreiveOperatorDetails","DialogActions","autoFocus","marginTop","operatorFullName","indexOf","React","Component","Bar","toRunOnMount","fs","image","percent","flex","alignContent","transition","ref","runOnMount","ceil","boxSizing","minHeight","minWidth","paddingTop","wordBreak","BarChart","labels","colors","images","maxValue","justifyContent","l","i","AlertsTable","alertTypes","filteredAlerts","alertTypeFilter","paddingRight","Select","MenuItem","toDateString","prevTime","deltaInMs","colSpan","Databox","mounted","v","decimals","mountedAt","update","delta","initDisplayedData","requestAnimationFrame","finalDisplayedData","initial","format","subText","OverviewPage","gateways","flexWrap","borderRight","gateway","gw","renderAlertsSection","renderDataSection","osaAlerts","shrinkageAlerts","largeQtyWentDarkAlerts","src","alt","alertedItems","avgPiplineTimePerItemInDays","avgRecordsPerItem","OSAStats","turnoverTimes","t","itemLoc","history","prev","current","time","lastItemScan","itemCountHistory","backroomId","ErrorPage","Alert","severity","AlertTitle","prettyFloat","formatTurnoverTime","tMs","OnShelfAvailabilityPage","first","selectedGatewayId","osaStats","turnoverTimeHistogram","gwId","metricBox","itemCountAtGateway","itemCountAtBackroom","datasets","fill","lineTension","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","pointBorderColor","pointBackgroundColor","pointBorderWidth","pointHoverRadius","pointHoverBackgroundColor","pointHoverBorderColor","pointHoverBorderWidth","pointRadius","pointHitRadius","gatewayItemCountHistory","backroomItemCountHistory","scales","xAxes","type","distribution","offset","yAxes","ticks","beginAtZero","maintainAspectRatio","legend","avgTurnoverTime","borderWidth","hoverBackgroundColor","hoverBorderColor","iconUrl","routes","name","path","menuImg","cssClass","displayIndex","itemWentDarkAlertsByTime","itemSkippedPOSAlertsByTime","alertedItemsCountLast24Hours","alertedItemsCountLast30Days","subTitle","getCurrentRoute","hash","Link","SideMenu","route","currentRoute","dangerouslySetInnerHTML","__html","marginBottom","navigateTo","onhashchange","LoadingPage","loadingCaption","setInterval","join","App","maxWidth","position","top","left","bottom","right","PageComponent","stores","createStores","ReactDOM","render","document","getElementById","navigator","serviceWorker","then","registration","unregister","catch","console","message"],"mappings":"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","file":"static/js/main.a75b1b58.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","export const names = [\"Clere\", \"Edbert\", \"Kareem\", \"Topper\", \"Busey\", \"Woody\", \"Ikkela\", \"Jenesia\", \"Deirdre\", \"Bloom\", \"Ellwood\", \"Burget\", \"Carnay\", \"Karlotte\", \"Vins\", \"Obau\", \"Adoree\", \"Jensen\", \"Lemuela\", \"Nahum\", \"Eskill\", \"Deeanne\", \"Hayes\", \"Meridel\", \"Flemming\", \"Eldwin\", \"Om\", \"Weisbrodt\", \"Scheer\", \"Carlen\", \"Armalda\", \"Schindler\", \"Rahman\", \"Tolley\", \"Sherwin\", \"Avelin\", \"Xever\", \"Lanny\", \"Jedidiah\", \"Dorie\", \"Madalena\", \"Langston\", \"Halle\", \"Ileana\", \"Hunley\", \"Juieta\", \"Ngo\", \"Lubet\", \"Marlene\", \"Ruthanne\", \"Stover\", \"Decca\", \"Marrin\", \"Taite\", \"Mae\", \"Wester\", \"Bricker\", \"Prissy\", \"Eadith\", \"Zacharie\", \"Malarkey\", \"Prakash\", \"Eichman\", \"Helbonnas\", \"Truc\", \"Horatia\", \"McConnell\", \"Stanhope\", \"Lathan\", \"Hax\", \"Erick\", \"Denney\", \"Faludi\", \"Cherry\", \"Keefer\", \"Jarib\", \"Ahrens\", \"Olwen\", \"Farris\", \"Bibbie\", \"Mont\", \"Sunil\", \"McNalley\", \"Girovard\", \"Schreibe\", \"Kilgore\", \"Stevana\", \"Gabler\", \"Phillida\", \"Putnam\", \"Biagi\", \"Neau\", \"Katherin\", \"Sedgewake\", \"Eisler\", \"Cyrille\", \"Uri\", \"Tammany\", \"Hagar\", \"Amby\"]\n","import {names} from \"./names\";\nimport {GatewayConfig, LocationCategory} from \"./gateway-config\";\n\nexport type Stage = 'Factory' | 'Mixing' | 'Distribution' | 'Retail';\nexport const stages: Stage[] = ['Factory', 'Mixing', 'Distribution', 'Retail'];\nexport const stagesDisplay: {[stage in Stage]: string} = {\n    Factory: 'Factory',\n    Mixing: 'Mixing Center',\n    Distribution: 'Distribution Center',\n    Retail: 'Retail'\n};\n\nexport interface IRawScanRecord {\n    tagId: string,\n    latitude: string,\n    longitude: string,\n    eventType: \"PRESENCE\",\n    gatewayId: string,\n    timestamp: number,\n    eventValue: string\n}\n\nexport interface IRawScanRecordLowecaseKeys {\n    tagid: string,\n    latitude: string,\n    longitude: string,\n    eventtype: \"PRESENCE\",\n    gatewayid: string,\n    timestamp: number,\n    eventvalue: string\n}\n\nconst hashCode = s => Math.abs(s.split('').reduce((a,b)=>{a=((a<<5)-a)+b.charCodeAt(0);return a&a},0));\n\nexport class ScanRecord {\n    private rawLowecase: IRawScanRecordLowecaseKeys;\n    constructor(public raw: IRawScanRecord, private gatewayConfig: GatewayConfig) {\n        this.rawLowecase = {} as IRawScanRecordLowecaseKeys;\n        Object.keys(raw).forEach(k => this.rawLowecase[k.toLowerCase()] = raw[k]);\n    }\n\n    itemId(): string {\n        return this.rawLowecase.tagid;\n    }\n\n    timestampInSeconds(): number {\n        return this.timestampInMilliseconds() / 1000;\n    }\n\n    timestampInMilliseconds(): number {\n        return this.rawLowecase.timestamp * 1000;\n    }\n\n    timestampAsDate(): Date {\n        return new Date(this.timestampInMilliseconds());\n    }\n\n    gatewayId(): string {\n        return this.rawLowecase.gatewayid;\n    }\n\n    eventType(): string {\n        return this.rawLowecase.eventtype;\n    }\n\n    eventValue(): string {\n        return this.rawLowecase.eventvalue;\n    }\n\n    gatewayAlias(): string {\n        const cfg = this.gatewayConfig.getFor(this.rawLowecase.gatewayid);\n        return cfg ? cfg.Alias : this.rawLowecase.gatewayid;\n    }\n\n    gatewayLocationCategory(): LocationCategory {\n        const cfg = this.gatewayConfig.getFor(this.rawLowecase.gatewayid);\n        return cfg ? cfg.LocationCategory : null;\n    }\n\n    recordId(): string {\n        // TODO - get from server\n        return hashCode(JSON.stringify(this.raw)).toString();\n    }\n\n    isOperatorAvailable(): boolean {\n        // return this.partner().toLowerCase() == 'p&g';\n        return false\n    }\n\n    operatorFullName(): string {\n        const h = hashCode(this.recordId());\n        const firstName = names[h % names.length];\n        const lastName = names[(h+1) % names.length];\n        return `${firstName} ${lastName}`;\n    }\n}\n","import {observable} from \"mobx\";\nimport {IRawScanRecord, ScanRecord} from \"./record\";\nimport {GatewayConfig} from \"./gateway-config\";\nimport * as _ from \"lodash\";\n\nexport class RecordStore {\n\n    @observable ready = false;\n    @observable err: Error = null;\n\n    @observable records: ScanRecord[] = [];\n\n    constructor(private gatewayConfig: GatewayConfig, pollingIntervalMs = 1000) {\n        this.init(pollingIntervalMs)\n    }\n\n    private async init(pollingIntervalMs: number) {\n        try {\n            const now = Date.now();\n            await this.fetch();\n            // const delay = Math.max(0, 800 - (Date.now() - now));\n            const delay = 1;\n            setTimeout(() => this.ready = true, delay);\n\n            const f = async () => {\n                try {\n                    await this.fetch();\n                    setTimeout(f, pollingIntervalMs)\n                } catch (e) {\n                    this.err = e;\n                }\n            };\n            f();\n        } catch (e) {\n            this.err = e;\n        }\n    }\n\n    public async fetch() {\n        const res = await fetch(process.env.REACT_APP_RECORDS_URL || \"https://png-collector.herokuapp.com/getAllEvents\");\n        const records: IRawScanRecord[] = await res.json();\n\n        if (this.records == null || records.length != this.records.length) {\n            this.records = records\n                .filter(r => (r as any).msg != \"[object Object]\")\n                .filter(r => Object.keys(r).map(k => k.toLowerCase()).find(x => x == \"tagid\"))\n                .map(raw => new ScanRecord(raw, this.gatewayConfig));\n            this.records = _.sortBy(this.records, r => r.timestampInMilliseconds());\n        }\n    }\n}\n","import {RecordStore} from \"./record-store\";\nimport * as _ from \"lodash\";\nimport {computed} from \"mobx\";\nimport {ScanRecord} from \"./record\";\nimport {IAlert} from \"./alerts\";\n\nexport interface IRepeatedScanAlert extends IAlert {\n    location: string,\n    prevTime: Date\n}\n\nexport interface ITooManyScansAlert extends IAlert {\n    count: number\n}\nexport const TooManyScansAlertThreshold = 10;\n\nexport interface IAdjacentScansAlert extends IAlert {\n    deltaInMs: number\n}\nexport const AdjacentScansAlertThresholdMs = 15 * 60 * 1000;\n\nexport class Statistics {\n\n    constructor(public recordsStore: RecordStore) {}\n\n    @computed get avgRecordsPerItem(): number {\n        return _.chain(this.recordsStore.records)\n            .groupBy(r => r.itemId())\n            .values()\n            .map((pRecs: ScanRecord[]) => pRecs.length)\n            .mean()\n            .value() || 0\n    }\n\n    @computed get avgPiplineTimePerItemInDays(): number {\n        return this.avgPiplineTimePerItemInSeconds / 60 / 60 / 24;\n    }\n\n    @computed get avgPiplineTimePerItemInSeconds(): number {\n        const now = Date.now() / 1000;\n        return _.chain(this.recordsStore.records)\n            .groupBy(r => r.itemId())\n            .mapValues((recs: ScanRecord[]) => now - _.min(recs.map(r => r.timestampInSeconds())))\n            .map(n => Math.max(n, 0))\n            .mean()\n            .value() || 0;\n    }\n\n    itemPipelineTimeInSeconds(item: string): number {\n        const now = Date.now() / 1000;\n        return now - _.min(this.itemRecords(item).map(r => r.timestampInSeconds()));\n    }\n\n    @computed get itemUIDs(): string[] {\n        return _.chain(this.recordsStore.records)\n            .map(r => r.itemId())\n            .uniq()\n            .value();\n    }\n\n    @computed get latestRecordsPerItem(): ScanRecord[] {\n        return _.chain(this.recordsStore.records)\n            .groupBy(r => r.itemId())\n            .mapValues((recs: ScanRecord[]) => _.maxBy(recs, (r: ScanRecord) => r.timestampInSeconds()))\n            .values()\n            .value()\n    }\n\n    @computed get _itemRecords(): {[itemId: string]: ScanRecord[]} {\n        const itemRecords: {[itemId: string]: ScanRecord[]} = {};\n        for (const rec of this.recordsStore.records) {\n            itemRecords[rec.itemId()] = itemRecords[rec.itemId()] || [];\n            itemRecords[rec.itemId()].push(rec);\n        }\n        return itemRecords;\n    }\n\n    public itemRecords(itemId: string): ScanRecord[] {\n        return this._itemRecords[itemId] || [];\n    }\n\n    public itemRecordsSortedByTime(itemId: string): ScanRecord[] {\n        return _.sortBy(this.itemRecords(itemId), r => r.timestampInMilliseconds());\n    }\n\n    @computed get _itemCountByGateway(): {[gatewayId: string]: number} {\n        return _.chain(this.latestRecordsPerItem)\n            .groupBy(r => r.gatewayId().toLowerCase())\n            .mapValues(recs => recs.length)\n            .value();\n    }\n\n    itemCountByGateway(gatewayId: string): number {\n        return this._itemCountByGateway[gatewayId.toLowerCase()] || 0;\n    }\n\n    @computed get alerts(): IAlert[] {\n        return this.tooManyScansAlerts;\n    }\n\n    @computed get alertedItems(): string[] {\n        return _.uniq(this.alerts.map(a => a.itemId));\n    }\n\n    @computed get tooManyScansAlerts(): ITooManyScansAlert[] {\n        return this.itemUIDs\n            .map(uid => this.itemRecordsSortedByTime(uid))\n            .filter(records => records.length > TooManyScansAlertThreshold)\n            .map(records => ({\n                timestamp: records[TooManyScansAlertThreshold].timestampAsDate(),\n                category: 'General',\n                alertType: 'Too Many Scans',\n                itemId: records[0].itemId(),\n                count: records.length\n            }));\n    }\n}\n","import * as Papa from \"papaparse\";\nimport * as _ from \"lodash\";\nimport {computed, observable} from \"mobx\";\n\nexport type LocationCategory = \"Truck\" | \"Customer DC Shelf\" | \"Customer Backroom\" | \"Customer Retail Shelf\" | \"POS\" | \"Front Door\" | string;\nexport const LocationCategories: LocationCategory[]  = [\"Truck\", \"Customer DC Shelf\", \"Customer Backroom\", \"Customer Retail Shelf\", \"POS\", \"Front Door\"];\n\nexport interface IGatewayConfigRecord {\n    ID: string;\n    Alias?: string;\n    LocationCategory?: LocationCategory;\n    SiteCategory?: string;\n    BackroomGatewayId?: string;\n}\n\nfunction findLocationCategory(cat: string): LocationCategory {\n    if (!cat) {\n        return cat;\n    }\n    return LocationCategories.find(x => x.replace(/\\s/g, \"\").toLowerCase() == cat.replace(/\\s/g, \"\").toLowerCase()) || cat;\n}\n\nexport async function loadGatewayConfigRecords(url: string): Promise<IGatewayConfigRecord[]> {\n    const stripKey = (x): string => x.replace(/\\s/g, \"\").toLowerCase();\n    const strip = (x) : string => x == null ? null : x.trim() != \"\" ? x.trim() : null;\n\n    return new Promise<IGatewayConfigRecord[]>((resolve, reject) => {\n        Papa.parse(url, {\n            download: true,\n            header: true,\n            error: (err) => reject(err),\n            complete: (results) => {\n                resolve(results.data\n                    .filter(r => Object.keys(r).filter(x => strip(r[x]) != null).length > 0)\n                    .map(r => {\n                        Object.keys(r).forEach(k => {\n                            const newK = stripKey(k);\n                            if (newK == \"\") {\n                                delete r[k];\n                            } else {\n                                r[newK] = r[k];\n                            }\n                        });\n                        return r\n                    })\n                    .map(r => ({\n                        ID: strip(r.id),\n                        Alias: strip(r.alias),\n                        LocationCategory: findLocationCategory(strip(r.locationcategory)),\n                        SiteCategory: strip(r.sitecategory),\n                        BackroomGatewayId: strip(r.backroomgatewayid)\n                    }))\n                );\n            }\n        })\n    });\n}\n\nfunction defaultConfig(gatewayId: string): IGatewayConfigRecord {\n    return {ID: gatewayId}\n}\n\nexport class GatewayConfig {\n\n    @observable ready: boolean;\n    @observable err: Error;\n\n    private records: IGatewayConfigRecord[];\n    private configById: {[id: string]: IGatewayConfigRecord} = {};\n\n    constructor() {\n        this.init();\n    }\n\n    private async init() {\n        try {\n            this.records = await loadGatewayConfigRecords(process.env.REACT_APP_GATEWAY_CONFIG_URL || \"https://trackntrace-config.s3.amazonaws.com/gw-conf.csv?AWSAccessKeyId=AKIA2SZDVCH33R4YMMVC&Signature=4uE4VaePWxQg3nOR%2Ff%2B5NJzhAUs%3D&Expires=1901521907\");\n            this.prevalidateConfig();\n            for (const rec of this.records) {\n                this.configById[rec.ID.toLowerCase()] = rec;\n            }\n            this.postvalidateConfig();\n            this.ready = true;\n        } catch (e) {\n            this.err = e;\n        }\n    }\n\n    private prevalidateConfig() {\n        for (const rec of this.records) {\n            if (rec.ID == null) { throw new Error(`Invalid gateway config: missing gateway ID`); }\n            // if (rec.LocationCategory && LocationCategories.indexOf(rec.LocationCategory) == -1) { throw new Error(`Invalid gateway location category for ${rec.ID}: provided is ${rec.LocationCategory}, allowed values are ${LocationCategories.join(',')}`); }\n        }\n    }\n\n    private postvalidateConfig() {\n        for (const rec of this.records) {\n            if (this.configById[rec.ID.toLowerCase()] != rec) { throw new Error(`Multiple gateways with same ID: ${rec.ID}`); }\n            if (rec.BackroomGatewayId && this.getFor(rec.BackroomGatewayId) == null) { throw new Error(`Invalid backroomGatewayId for gateway ${rec.ID}`); }\n        }\n    }\n\n    getFor(gatewayId: string): IGatewayConfigRecord {\n        return _.cloneDeep(this.configById[gatewayId.toLowerCase()]);\n    }\n\n    all(): IGatewayConfigRecord[] {\n        return _.cloneDeep(this.records);\n    }\n\n    @computed get customerBackrooms(): IGatewayConfigRecord[] {\n        return this.all().filter(c => c.LocationCategory == \"Customer Backroom\");\n    }\n\n    @computed get customerRetailShelves(): IGatewayConfigRecord[] {\n        return this.all().filter(c => c.LocationCategory == \"Customer Retail Shelf\");\n    }\n\n    @computed get POSes(): IGatewayConfigRecord[] {\n        return this.all().filter(c => c.LocationCategory == \"POS\");\n    }\n\n    @computed get FrontDoors(): IGatewayConfigRecord[] {\n        return this.all().filter(c => c.LocationCategory == \"Front Door\");\n    }\n}\n","import {Statistics} from \"./statistics\";\nimport {computed} from \"mobx\";\nimport {AlertType, IAlert} from \"./alerts\";\nimport {GatewayConfig} from \"./gateway-config\";\n\nexport class OSAAlerts {\n\n    constructor(private statistics: Statistics, private gatewayConfig: GatewayConfig) {}\n\n    @computed get inventoryNotOnShelfAlerts(): IAlert[] {\n        return this.gatewayConfig.customerRetailShelves.map(shelf => {\n            if (!shelf.BackroomGatewayId) return;\n\n            const backroom = this.gatewayConfig.getFor(shelf.BackroomGatewayId);\n            const onShelf = this.statistics.itemCountByGateway(shelf.ID);\n            if (backroom && onShelf < 3) {\n                const inBackroom = this.statistics.itemCountByGateway(backroom.ID);\n                if (inBackroom >= 1) {\n                    return {\n                        timestamp: new Date(),\n                        category: 'OSA',\n                        alertType: \"Inventory Not On Shelf\",\n                        gatewayId: shelf.ID\n                    } as IAlert;\n                }\n            }\n            return null;\n        }).filter(x => x != null);\n    }\n\n    @computed get backroomInventoryLowAlerts(): IAlert[] {\n        return this.gatewayConfig.customerBackrooms.map(backroom => {\n            const inBackroom = this.statistics.itemCountByGateway(backroom.ID);\n            if (inBackroom == 0) {\n                return {\n                    timestamp: new Date(),\n                    category: \"OSA\",\n                    alertType: \"Backroom Inventory Low\",\n                    gatewayId: backroom.ID,\n                } as IAlert;\n            }\n            return null;\n        }).filter(x => x);\n    }\n\n    @computed get alerts(): IAlert[] {\n        return this.inventoryNotOnShelfAlerts.concat(this.backroomInventoryLowAlerts);\n    }\n\n}\n","import * as _ from \"lodash\";\n\nexport type AlertType = 'Repeated Scan' | 'Too Many Scans' | 'Adjacent Scans' | 'Inventory Not On Shelf' | 'Backroom Inventory Low' | 'Item Skipped POS' | 'Item Went Dark' | 'Large Quantity Went Dark';\nexport type AlertCategory = 'OSA' | 'Shrinkage' | 'General';\n\nexport interface IAlert {\n    timestamp: Date,\n    category: AlertCategory,\n    alertType: AlertType,\n    itemId?: string,\n    gatewayId?: string\n}\n\nexport function alertsByTime(alerts: IAlert[], nBins: number, minBinSize: number): {bins: number[], binSize: number, startTime: number} {\n    if (alerts.length == 0) return {bins: [], binSize: 0, startTime: 0};\n\n    const times = alerts.map(a => a.timestamp.getTime());\n    const startTime = _.min(times);\n    let binSize = (_.max(times) + 1 - startTime) / nBins;\n    if (minBinSize > binSize) {\n        binSize = minBinSize;\n        nBins = Math.floor((_.max(times) + 1 - startTime) / binSize) + 1\n    }\n    const bins = _.range(nBins).map(() => 0);\n\n    for (const a of alerts) {\n        bins[Math.floor((a.timestamp.getTime() - startTime) / binSize)]++;\n    }\n\n    return {bins, binSize, startTime};\n}\n\nexport function alertsInLast(alerts: IAlert[], duration: number): IAlert[] {\n    return alerts.filter(a => a.timestamp.getTime() > Date.now() - duration);\n}\n","import * as _ from \"lodash\";\n\nimport {GatewayConfig} from \"./gateway-config\";\nimport {Statistics} from \"./statistics\";\nimport {computed} from \"mobx\";\nimport {ScanRecord} from \"./record\";\nimport {AlertCategory, alertsByTime, alertsInLast, AlertType, IAlert} from \"./alerts\";\n\nexport const GOING_DARK_TIMEOUT = 2*60*60*1000;\nexport const LARGE_QTY_WENT_DARK_THRESHOLD = 3;\n\nexport interface ILargeQuantityWentDarkAlert extends IAlert {\n    category: \"Shrinkage\",\n    alertType: \"Large Quantity Went Dark\",\n    quantity: number\n}\n\nexport class ShrinkageAlerts {\n\n    constructor(private statistics: Statistics, private gatewayConfig: GatewayConfig) {}\n\n    @computed get itemSkippedPOSAlerts(): IAlert[] {\n        return this.gatewayConfig.FrontDoors.map(frontDoor => {\n            if (!frontDoor.BackroomGatewayId) return null;\n\n            const pos = this.gatewayConfig.getFor(frontDoor.BackroomGatewayId);\n            if (!pos) return null;\n            if (pos.LocationCategory != \"POS\") return null;\n            if (!pos.BackroomGatewayId) return null;\n\n            const shelf = this.gatewayConfig.getFor(pos.BackroomGatewayId);\n            if (!shelf) return null;\n            if (shelf.LocationCategory != \"Customer Retail Shelf\") return null;\n\n            return this.statistics.itemUIDs.map(itemID => {\n                const recs = this.statistics.itemRecords(itemID);\n                const posRec = recs.find(r => r.gatewayId().toLowerCase() == pos.ID.toLowerCase());\n                const frontDoorRec = recs.find(r => r.gatewayId().toLowerCase() == frontDoor.ID.toLowerCase());\n                const shelfRec = recs.find(r => r.gatewayId().toLowerCase() == shelf.ID.toLowerCase());\n\n                if (frontDoorRec && shelfRec && !posRec) {\n                    return {\n                        timestamp: frontDoorRec.timestampAsDate(),\n                        category: \"Shrinkage\",\n                        alertType: \"Item Skipped POS\",\n                        itemId: itemID,\n                        gatewayId: frontDoor.ID\n                    } as IAlert\n                }\n\n                return null;\n            });\n        }).reduce((x, y) => x.concat(y), []).filter(x => x);\n    }\n\n    @computed get itemWentDarkAlerts(): IAlert[] {\n        return this.gatewayConfig.customerRetailShelves.map(shelf => {\n            return this.statistics.itemUIDs.map(itemID => {\n                const recs = this.statistics.itemRecords(itemID);\n                const shelfRecs = recs.filter(r => r.gatewayId().toLowerCase() == shelf.ID.toLowerCase());\n                if (shelfRecs.length > 0) {\n                    const posRec = recs.find(r => r.gatewayLocationCategory() == \"POS\");\n                    if (!posRec) {\n                        const lastShelfRec = shelfRecs[shelfRecs.length - 1];\n                        if (Date.now() - lastShelfRec.timestampInMilliseconds() > GOING_DARK_TIMEOUT) {\n                            return {\n                                timestamp: new Date(lastShelfRec.timestampInMilliseconds() + GOING_DARK_TIMEOUT),\n                                category: \"Shrinkage\",\n                                alertType: \"Item Went Dark\",\n                                itemId: itemID,\n                                gatewayId: shelf.ID,\n                            } as IAlert\n                        }\n                    }\n                }\n                return null;\n            });\n        }).reduce((x, y) => x.concat(y), []).filter(x => x);\n    }\n\n    @computed get largeQuantityWentDarkAlerts(): ILargeQuantityWentDarkAlert[] {\n        if (this.itemWentDarkAlerts.length > LARGE_QTY_WENT_DARK_THRESHOLD) {\n            const sortedByTime = _.sortBy(this.itemWentDarkAlerts, alert => alert.timestamp.getTime());\n            return [\n                {\n                    timestamp: sortedByTime[LARGE_QTY_WENT_DARK_THRESHOLD - 1].timestamp,\n                    category: \"Shrinkage\",\n                    alertType: \"Large Quantity Went Dark\",\n                    quantity: this.itemWentDarkAlerts.length\n                }\n            ]\n        }\n        return [];\n    }\n\n    @computed get alertedItemsCountLast24Hours(): number {\n        const DURATION = 24*60*60*1000;\n        return _.uniq(\n            alertsInLast(this.itemSkippedPOSAlerts, DURATION)\n            .concat(alertsInLast(this.itemWentDarkAlerts, DURATION))\n            .map(alert => alert.itemId)\n        ).length;\n    }\n\n    @computed get alertedItemsCountLast30Days(): number {\n        const DURATION = 30*24*60*60*1000;\n        return _.uniq(\n            alertsInLast(this.itemSkippedPOSAlerts, DURATION)\n            .concat(alertsInLast(this.itemWentDarkAlerts, DURATION))\n            .map(alert => alert.itemId)\n        ).length;\n    }\n\n    @computed get alerts(): IAlert[] {\n        return this.itemSkippedPOSAlerts.concat(this.itemWentDarkAlerts).concat(this.largeQuantityWentDarkAlerts);\n    }\n\n}\n","export function gatewayImage(gatewayId: string): string {\n    return process.env.REACT_APP_BASE_URL + ({\n        [\"3c71bf63e190\".toLowerCase()]: '/mixingcenter.svg',\n        [\"GW98f4ab141D14\".toLowerCase()]: '/factory.svg',\n        [\"GW984fab141D70\".toLowerCase()]: '/truck.svg', //\"P&G Truck\",\n        [\"GW98f4ab141D70\".toLowerCase()]: '/truck.svg', //\"P&G Truck\",\n        [\"GW98f4ab141D38\".toLowerCase()]: '/distributioncenter.svg',\n        [\"GW98f4ab141DF4\".toLowerCase()]: '/inventory.svg', //\"Customer DC or P&G DC Shelf\",\n        [\"GW98f4ab141D0C\".toLowerCase()]: '/retailstorage.svg',\n        // [\"Original\".toLowerCase()]:  '/mixingcenter.svg',\n        // [\"P&G Manufacturing\".toLowerCase()]:  '/factory.svg',\n        // [\"P&G Truck\".toLowerCase()]:  '/truck.svg', //\"P&G Truck\",\n        // [\"Customer DC or P&G DC\".toLowerCase()]:  '/distributioncenter.svg',\n        // [\"Customer DC or P&G DC Shelf\".toLowerCase()]:  '/inventory.svg', //\"Customer DC or P&G DC Shelf\",\n        // [\"P&G Customer Store\".toLowerCase()]:  '/retailstorage.svg',\n    }[gatewayId.toLowerCase()] || '/mixingcenter.svg');\n}\n\nexport function partnerBrandImage(brand: string): string {\n    return process.env.REACT_APP_BASE_URL + {\n        'amazon': '/amazon.png',\n        'p&g': '/png.png',\n        'fedex': '/fedex.png',\n        'dhl': '/dhl.png'\n    }[brand.toLowerCase()] || '/unknown_brand.png';\n}\n\nexport function stageImage(stage: string): string {\n    return process.env.REACT_APP_BASE_URL + {\n        'factory': '/factory.svg',\n        'mixing': '/mixingcenter.svg',\n        'distribution': '/distributioncenter.svg',\n        'retail': '/retailstorage.svg'\n    }[stage.toLowerCase().replace(/\\s/g, \"\")] || '/unknown_stage.svg';\n}\n\n","import React from \"react\";\n\nexport const PageHeader = ({title}) => <div style={{\n    height: 96,\n    borderBottom: '1px solid #ebedf8',\n    fontWeight: \"bold\",\n    display: 'flex',\n    alignItems: 'center',\n    paddingLeft: 20\n}}>\n    <div>{title}</div>\n</div>\n","import React from \"react\";\nimport * as _ from \"lodash\";\nimport {inject, observer} from \"mobx-react\";\nimport {Statistics} from \"./statistics\";\nimport {observable, reaction} from \"mobx\";\nimport {Button, CircularProgress, DialogTitle, TablePagination, TextField} from \"@material-ui/core\";\nimport {Autocomplete, createFilterOptions} from \"@material-ui/lab\";\nimport {gatewayImage, partnerBrandImage, stageImage} from \"./resources\";\nimport {ScanRecord, stagesDisplay} from \"./record\";\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\nimport AccountCircleOutlinedIcon from '@material-ui/icons/AccountCircleOutlined';\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport {PageHeader} from \"./page-header\";\n\nconst twodigits = (n:number) => (n < 10 ? '0' : '') + n.toString();\n\n@inject(\"statistics\")\n@observer\nexport class ItemStatusPage extends React.Component<{statistics: Statistics}, {}> {\n\n    @observable private selectedItemUID: string;\n    @observable private ready = false;\n    @observable private pageSize: number = 5;\n    @observable private currentPage: number = 0;\n    private currentTimeoutHandle;\n\n    get selected(): string {\n        return this.selectedItemUID != null ?\n            (\n                this.props.statistics.itemUIDs.indexOf(this.selectedItemUID) != -1 ?\n                    this.selectedItemUID\n                    :\n                    null\n            )\n            : this.props.statistics.itemUIDs[0];\n    }\n\n    componentDidMount() {\n        this.loadData();\n        reaction(\n            () => this.selected,\n            () => this.loadData()\n        )\n    }\n\n    loadData() {\n        const uid = this.selected;\n        if (uid) {\n            this.ready = false;\n            if (this.currentTimeoutHandle) {\n                clearTimeout(this.currentTimeoutHandle);\n            }\n            this.currentTimeoutHandle = setTimeout(() => {\n                this.ready = true;\n                this.currentTimeoutHandle = null;\n            }, 1000);\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.currentTimeoutHandle) {\n            clearTimeout(this.currentTimeoutHandle);\n        }\n    }\n\n    render() {\n        const records = this.props.statistics.itemRecords(this.selected);\n        return <div>\n            <PageHeader title={\"Item Scan History\"}/>\n            <div style={{margin: \"0 0 0 30px\"}}>\n            <div style={{\n                display: 'flex',\n                alignItems: 'center'\n            }}>\n                <div style={{\n                    display: 'inline-block',\n                    fontWeight: 'bold',\n                    fontSize: 21,\n                    padding: '32px 15px 32px 0'\n                }}>Search an item:</div>\n                {this.props.statistics.itemUIDs.length > 0 && <Autocomplete\n                    options={this.props.statistics.itemUIDs}\n                    getOptionLabel={option => option}\n                    style={{ width: 300}}\n                    filterOptions={createFilterOptions({\n                        matchFrom: 'start'\n                    })}\n                    onChange={(e, value) => {\n                        this.selectedItemUID = value;\n                        this.loadData();\n                    }}\n                    value={this.selectedItemUID == null ? this.selected : this.selectedItemUID}\n                    renderInput={params => <TextField {...params} label=\"Item UID\" variant=\"outlined\" />}\n                />}\n                {!this.ready && <CircularProgress style={{marginLeft: 20}}/>}\n            </div>\n            {this.selected != null && this.ready && <div style={{\n                borderRadius: 4,\n                border: \"solid 1px #ebedf8\",\n                backgroundColor: \"#f8f8f8\",\n                padding: 37,\n                display: 'flex',\n                flexDirection: 'row',\n                marginRight: 30,\n                overflow: \"auto\"\n            }}>\n                <div>\n                    <div style={{\n                        fontSize: 19,\n                        color: \"#1a173b\",\n                        letterSpacing: 0.13,\n                        paddingBottom: 12\n                    }}>\n                        Item UID\n                    </div>\n                    <div style={{\n                        color: \"#484848\",\n                        fontSize: 15\n                    }}>\n                        {this.selected}\n                    </div>\n                </div>\n                <div>\n                    <table className={\"item-table\"} style={{\n                        paddingLeft: 40\n                    }}>\n                        <tr style={{\n                            fontSize: 15,\n                            letterSpacing: 0.1,\n                            color: \"#5e6e7b\"\n                        }}>\n                            <td>Brand</td>\n                            <td>Description</td>\n                            <td>Catalog No.</td>\n                            <td>Time in pipeline</td>\n                            <td>Status</td>\n                        </tr>\n                        <tr style={{\n                            fontSize: 16,\n                            color: \"#060606\"\n                        }}>\n                            <td>Gillette</td>\n                            <td>Razor Package 135Xg</td>\n                            <td>1225434DLX</td>\n                            <td>{Math.floor(this.props.statistics.itemPipelineTimeInSeconds(this.selected) / 60 / 60 / 24)} days</td>\n                            <td style={{\n                                fontWeight: 'bold',\n                                fontSize: 16,\n                                color: '#769806'\n                            }}>OK</td>\n                        </tr>\n                    </table>\n                </div>\n            </div>}\n            {this.selected && this.ready && <div>\n                <div style={{\n                    display: 'inline-block',\n                    fontWeight: 'bold',\n                    fontSize: 21,\n                    padding: '32px 15px 32px 0',\n                    borderBottom: \"solid 0.5px #ebedf8\",\n                    width: \"100%\"\n                }}>Item history</div>\n                <div>\n                    <div className={'item-history-table'}>\n                        <table>\n                            <tr>\n                                <td></td>\n                                <td>Gateway</td>\n                                <td>Gateway ID</td>\n                                <td>Event Type</td>\n                                <td>Event Value</td>\n                                <td>Date</td>\n                                <td>Time</td>\n                            </tr>\n                            {\n                                _.sortBy(records, r => -r.timestampInSeconds()).slice(this.pageSize * this.currentPage, this.pageSize * (this.currentPage + 1))\n                                    .map(r => <tr>\n                                        <td className={'record-id-cell'}>Record {r.recordId()}</td>\n                                        <td style={{textAlign: 'left'}}>\n                                            <div style={{\n                                                verticalAlign: 'middle',\n                                                width: 30,\n                                                height: 30,\n                                                backgroundImage: `url(${gatewayImage(r.gatewayId())})`,\n                                                backgroundSize: 'contain',\n                                                backgroundRepeat: 'no-repeat',\n                                                whiteSpace: 'nowrap',\n                                                backgroundPosition: 'center',\n                                                display: 'inline-block'\n                                            }}/>\n                                            &nbsp;&nbsp;&nbsp;{r.gatewayAlias()}\n                                        </td>\n                                        <td> {r.gatewayId()} </td>\n                                        <td> {r.eventType()} </td>\n                                        <td> {r.eventValue()} </td>\n                                        <td>{`${twodigits(r.timestampAsDate().getDate())} ${r.timestampAsDate().toLocaleString('default', { month: 'short' })}, ${r.timestampAsDate().getFullYear()}`}</td>\n                                        <td>{`${twodigits(r.timestampAsDate().getHours())}:${twodigits(r.timestampAsDate().getMinutes())}`}</td>\n                                    </tr>)\n                            }\n                        </table>\n                        <TablePagination\n                            rowsPerPageOptions={[5, 10]}\n                            component=\"div\"\n                            count={records.length}\n                            rowsPerPage={this.pageSize}\n                            page={this.currentPage}\n                            onChangePage={(e, page) => this.currentPage = page}\n                            onChangeRowsPerPage={(e) => {\n                                this.pageSize = parseInt(e.target.value)\n                            }}\n                        />\n                        {this.isOperatorDialogOpen() && <Dialog onClose={() => this.closeOperatorDialog()} aria-labelledby=\"Scan Operator Details\" open={this.isOperatorDialogOpen()}>\n                            <div style={{fontSize: 20, fontWeight: 'bold', margin: 20}}>Scan Operator Details</div>\n                            <DialogContent style={{textAlign: 'left'}}>\n                                You are attempting to retrieve operator details of scan { this.scanRecordForOperatorRetreival.recordId() }.<br/><br/>\n                                <b>Note - this action will be logged!</b><br/><br/>\n                                <div style={{textAlign: 'center'}}>\n                                    {\n                                        this.retrievingDetails ? <CircularProgress/>\n                                        : !this.operatorDetails ? <Button variant=\"contained\" color=\"primary\" onClick={() => this.retreiveOperatorDetails()}>RETRIEVE OEPRATOR DETAILS</Button>\n                                            : <span>Full name: <b>{this.operatorDetails}</b></span>\n                                    }\n                                </div>\n                                <DialogActions>\n                                    <Button autoFocus onClick={() => this.closeOperatorDialog()} color=\"primary\" style={{marginTop: 20}}>\n                                        {this.operatorDetails ? 'DONE' : 'CANCEL'}\n                                    </Button>\n                                </DialogActions>\n                            </DialogContent>\n                        </Dialog>}\n                    </div>\n                </div>\n            </div>}\n        </div>\n        </div>\n    }\n\n    @observable retrievingDetails = false;\n    @observable operatorDetails = null;\n\n    private retreiveOperatorDetails() {\n        this.retrievingDetails = true;\n        setTimeout(() => {\n            this.retrievingDetails = false;\n            this.operatorDetails = this.scanRecordForOperatorRetreival.operatorFullName();\n        }, 3000)\n    }\n\n    @observable scanRecordForOperatorRetreival: ScanRecord;\n\n    private openOperatorRetreivalDialog(r: ScanRecord) {\n        this.scanRecordForOperatorRetreival = r;\n    }\n\n    private closeOperatorDialog() {\n        this.scanRecordForOperatorRetreival = null;\n        this.operatorDetails = null;\n    }\n\n    private isOperatorDialogOpen(): boolean {\n        return this.scanRecordForOperatorRetreival != null;\n    }\n}\n","import * as _ from \"lodash\";\nimport React from \"react\";\n\nconst scale = 0.6;\n\nclass Bar extends React.Component<{\n                 label: string,\n                 value: number,\n                 color: string,\n                 image: string,\n                 percent: number\n             }, {}> {\n\n    toRunOnMount = [];\n\n    componentDidMount() {\n        const fs = this.toRunOnMount;\n        this.toRunOnMount = null;\n        fs.forEach(f => f());\n    }\n\n    runOnMount(f) {\n        if (this.toRunOnMount == null) {\n            f();\n        } else {\n            this.toRunOnMount.push(f);\n        }\n    }\n\n    render() {\n        const {label, value, color, image, percent} = this.props;\n\n        return <div style={{\n            display: 'flex',\n            flexDirection: 'column',\n            margin: \"0 3px\"\n        }}>\n            <div\n                style={{flex: 1, display: \"flex\", flexDirection: \"column\", alignContent: 'flex-end', paddingBottom: 5}}>\n                <div style={{flex: 1}}/>\n                <div style={{textAlign: 'center', fontSize: 40 * scale, paddingBottom: 3}}>{value}</div>\n                <div style={{\n                    backgroundColor: color,\n                    height: 0,\n                    transition: 'height 1s'\n                }} ref={e => this.runOnMount(() => {\n                    setTimeout(() => {\n                        if (e) e.style.height = `${Math.ceil(percent * 100)}%`\n                    }, 10);\n                })}/>\n            </div>\n            <div style={{\n                height: 124 * scale + 10,\n                width: 134 * scale,\n                backgroundColor: \"#e9e9e9\",\n                boxSizing: 'border-box',\n                display: 'flex',\n                flexDirection: 'column',\n                fontSize: 16 * scale,\n                color: \"#060606\",\n                alignItems: 'center'\n            }}>\n                <div style={{\n                    height: 70 * scale,\n                    minHeight: 70 * scale,\n                    width: 70 * scale,\n                    minWidth: 70 * scale,\n                    marginTop: 20 * scale,\n                    backgroundImage: `url(${image})`,\n                    backgroundPosition: 'center',\n                    backgroundRepeat: 'no-repeat',\n                    backgroundSize: 'contain',\n                }}/>\n                <span style={{\n                    textAlign: 'center',\n                    paddingTop: 5,\n                    paddingBottom: 20 * scale,\n                    wordBreak: 'break-word'\n                }}>{label}</span>\n            </div>\n        </div>\n    }\n}\n\nexport class BarChart extends React.Component<{\n    labels: string[],\n    values: number[],\n    colors: string[],\n    images: string[]\n}, {}> {\n\n    render() {\n        const {labels, values, colors, images} = this.props;\n        const maxValue = _.max(values);\n        return <div style={{\n            width: '100%',\n            height: '100%',\n            display: 'flex',\n            flexDirection: 'row',\n            justifyContent: 'center'\n        }}>\n            {labels.map(\n                (l, i) => <Bar\n                    label={labels[i]}\n                    value={values[i]}\n                    image={images[i]}\n                    color={colors[i % colors.length]}\n                    percent={maxValue == 0 ? 0 : values[i] / maxValue}\n                />\n            )}\n            {/*{[labels[0], labels[1], labels[2], labels[3]].map(*/}\n            {/*    (l, i) => <Bar*/}\n            {/*        label={labels[i]}*/}\n            {/*        value={values[i]}*/}\n            {/*        image={images[i]}*/}\n            {/*        color={colors[i % colors.length]}*/}\n            {/*        percent={maxValue == 0 ? 0 : values[i] / maxValue}*/}\n            {/*    />*/}\n            {/*)}*/}\n        </div>\n    }\n\n}\n","import React from \"react\";\nimport {AlertType, IAlert} from \"./alerts\";\nimport * as _ from \"lodash\";\nimport {IAdjacentScansAlert, IRepeatedScanAlert, ITooManyScansAlert} from \"./statistics\";\nimport {ILargeQuantityWentDarkAlert} from \"./shrinkage-alerts\";\nimport {MenuItem, Select, TablePagination} from \"@material-ui/core\";\nimport {observer} from \"mobx-react\";\nimport {observable} from \"mobx\";\n\n@observer\nexport class AlertsTable extends React.Component<{alerts: IAlert[]}> {\n    @observable private rowsPerPage: number = 5;\n    @observable private page: number = 0;\n\n    @observable alertTypeFilter: AlertType | \"all\" = \"all\";\n\n    render() {\n        const {alerts} = this.props;\n        const alertTypes = _.uniq(alerts.map(a => a.alertType));\n        const filteredAlerts = alerts.filter(a => this.alertTypeFilter == \"all\" || a.alertType == this.alertTypeFilter);\n        return <div>\n            <div style={{textAlign: 'right', paddingRight: 20}}>\n                <div style={{display: 'inline-block', paddingRight: 10}}>Show only:</div>\n                <Select value={this.alertTypeFilter} onChange={(e) => {\n                    this.alertTypeFilter = e.target.value as AlertType;\n                    this.page = 0;\n                }}>\n                    <MenuItem value={\"all\"}>- All -</MenuItem>\n                    {alertTypes.map(a => <MenuItem value={a}>{a}</MenuItem>)}\n                </Select>\n            </div>\n            <table className={\"alerts-table\"}>\n                <tr>\n                    <td>TIMESTAMP</td>\n                    <td>CATEGORY</td>\n                    <td>ALERT TYPE</td>\n                    <td>ITEM ID</td>\n                    <td>GATEWAY</td>\n                    <td>DESCRIPTION</td>\n                </tr>\n                {filteredAlerts.length ?\n                    _.sortBy(filteredAlerts, alert => -alert.timestamp.getTime())\n                    .slice(this.page * this.rowsPerPage, (this.page+1) * this.rowsPerPage)\n                    .map((alert: IAlert) => <tr>\n                        <td style={{whiteSpace: \"nowrap\"}}>{alert.timestamp.toDateString()}</td>\n                        <td style={{whiteSpace: \"nowrap\"}}>{alert.category}</td>\n                        <td style={{whiteSpace: \"nowrap\"}}>{alert.alertType}</td>\n                        <td style={{whiteSpace: \"nowrap\"}}>{alert.itemId}</td>\n                        <td style={{whiteSpace: \"nowrap\"}}>{alert.gatewayId}</td>\n                        <td style={{width: \"100%\"}}>{\n                            alert.alertType == 'Repeated Scan' ?\n                                <span> Item was scanned twice at location <i>{(alert as IRepeatedScanAlert).location}</i> (previous scan was at {(alert as IRepeatedScanAlert).prevTime.toDateString()})</span>\n                                : alert.alertType == 'Too Many Scans' ?\n                                <span> Item was scanned <b>{(alert as ITooManyScansAlert).count}</b> times</span>\n                                : alert.alertType == 'Adjacent Scans' ?\n                                    <span> Detected two consecutive scans in different locations in under <b>{Math.ceil((alert as IAdjacentScansAlert).deltaInMs / 1000 / 60)}</b> minutes.</span>\n                                    : alert.alertType == 'Inventory Not On Shelf' ?\n                                        <span>Customer shelf contains less than 3 items.</span>\n                                        : alert.alertType == 'Backroom Inventory Low' ?\n                                            <span>Customer backroom is empty.</span>\n                                            : alert.alertType == 'Item Skipped POS' ?\n                                                <span>Item went from shelf to front door, skipped point-of-sale.</span>\n                                                : alert.alertType == 'Item Went Dark' ?\n                                                    <span>On-shelf item did not scan for more than {Math.floor((Date.now() - alert.timestamp.getTime()) / 60 / 60 / 1000)} hours.</span>\n                                                    : alert.alertType == 'Large Quantity Went Dark' ?\n                                                        <span> <b>{(alert as ILargeQuantityWentDarkAlert).quantity}</b> items went dark.</span>\n                                                        :\n                                                        <span></span>\n                        }</td>\n                    </tr>)\n                :   <tr><td colSpan={6} style={{textAlign: \"center\", color: \"grey\"}}>- No Alerts - </td></tr>\n                }\n            </table>\n            <TablePagination\n                rowsPerPageOptions={[5, 10]}\n                component=\"div\"\n                count={filteredAlerts.length}\n                rowsPerPage={this.rowsPerPage}\n                page={this.page}\n                onChangePage={(e, page) => this.page = page}\n                onChangeRowsPerPage={(e) => {\n                    this.rowsPerPage = parseInt(e.target.value)\n                }}\n            />\n        </div>\n    }\n\n}\n","import React from \"react\";\nimport * as _ from 'lodash';\nimport {inject, observer} from \"mobx-react\";\nimport {\n    AdjacentScansAlertThresholdMs, IAdjacentScansAlert,\n    IRepeatedScanAlert,\n    ITooManyScansAlert,\n    Statistics,\n    TooManyScansAlertThreshold\n} from \"./statistics\";\nimport {BarChart} from \"./bar-chart\";\nimport {observable, toJS} from \"mobx\";\nimport {gatewayImage, partnerBrandImage, stageImage} from \"./resources\";\nimport {TablePagination} from \"@material-ui/core\";\nimport {stages, stagesDisplay} from \"./record\";\nimport {GatewayConfig} from \"./gateway-config\";\nimport {OSAAlerts} from \"./osa-alerts\";\nimport {IAlert} from \"./alerts\";\nimport {\n    GOING_DARK_TIMEOUT,\n    ILargeQuantityWentDarkAlert,\n    LARGE_QTY_WENT_DARK_THRESHOLD,\n    ShrinkageAlerts\n} from \"./shrinkage-alerts\";\nimport {AlertsTable} from \"./alerts-table\";\n\n@observer\nclass Databox extends React.Component<{\n    title: string,\n    data: number\n    subText?: string\n    decimals?: number\n}, {}> {\n\n    @observable initDisplayedData: number = 0;\n    @observable finalDisplayedData: number = null;\n    @observable initial = true;\n\n    mounted = false;\n\n    format(v: number): string {\n        if (this.props.decimals) {\n            return `${Math.floor(v)}.${Math.floor(v * 10) % 10}`;\n        } else {\n            return `${v}`\n        }\n    }\n\n    componentDidMount() {\n        this.mounted = true;\n        const duration = 1000;\n        const data = this.props.data || 0;\n        const mountedAt = Date.now();\n        const update = () => {\n            if (this.mounted) {\n                const delta = Date.now() - mountedAt;\n                if (delta < duration) {\n                    this.initDisplayedData = Math.floor(data * (delta / duration));\n                    requestAnimationFrame(update);\n                } else {\n                    this.finalDisplayedData = data;\n                    this.initial = false;\n                }\n            }\n        };\n        update();\n    }\n\n    componentWillUnmount() {\n        this.mounted = false;\n    }\n\n    componentDidUpdate() {\n        this.finalDisplayedData = this.props.data;\n    }\n\n    render() {\n        return <div className={'databox'}>\n            <div className={'databox-title'}>{this.props.title}</div>\n            <div className={'databox-infotext'}>\n                <span>{this.format(this.initial ? this.initDisplayedData : this.finalDisplayedData)}</span>\n                {this.props.subText &&\n                    <div className={'databox-subtext'}>\n                        <span>{this.props.subText}</span>\n                    </div>\n                }\n            </div>\n        </div>\n    }\n\n}\n\n@inject('statistics', 'gatewayConfig', 'osaAlerts', 'shrinkageAlerts')\n@observer\nexport class OverviewPage extends React.Component<{\n    statistics: Statistics,\n    gatewayConfig: GatewayConfig,\n    osaAlerts: OSAAlerts\n    shrinkageAlerts: ShrinkageAlerts\n}, {}> {\n    @observable private rowsPerPage: number = 5;\n    @observable private page: number = 0;\n    render() {\n        const gateways = this.props.gatewayConfig.all().map(cfg => cfg.ID);\n\n        return <div style={{\n            height: '100%',\n            display: 'flex',\n            flexDirection: 'row',\n            flexWrap: 'wrap',\n            justifyContent: 'center',\n        }}>\n            <div style={{display: 'flex', flexDirection:'column', flex: 1, borderRight: '1px solid #ebedf8'}}>\n                <div style={{\n                    display: \"flex\",\n                    flexDirection: \"row\",\n                    flexWrap: 'wrap'\n                }}>\n                    <div style={{flex: 1, marginTop: 50}}>\n                        <div className=\"title\" style={{\n                            height: 46,\n                            borderBottom: '1px solid #ebedf8',\n                            alignItems: 'start'\n                        }}>\n                            <span>Products by gateway</span>\n                        </div>\n                        <div style={{height: 300, padding: 20, borderBottom: '1px solid #ebedf8'}}>\n                            <BarChart\n                                colors={[\"#035093\", \"#035093\", \"#4889c2\", \"#0a4171\"]}\n                                images={gateways.map(gateway => gatewayImage(gateway))}\n                                labels={gateways.map(gw => this.props.gatewayConfig.getFor(gw).Alias)}\n                                values={gateways.map(gateway => this.props.statistics.itemCountByGateway(gateway))}\n                            />\n                        </div>\n                    </div>\n                </div>\n                {this.renderAlertsSection()}\n            </div>\n            <div style={{\n                letterSpacing: 1.13,\n                fontSize: 19,\n            }}>\n                {this.renderDataSection()}\n            </div>\n        </div>\n    }\n\n    private renderAlertsSection() {\n        const inventoryNotOnShelfAlerts = this.props.osaAlerts.inventoryNotOnShelfAlerts;\n        const backroomInventoryLowAlerts = this.props.osaAlerts.backroomInventoryLowAlerts;\n        const itemSkippedPOSAlerts = this.props.shrinkageAlerts.itemSkippedPOSAlerts;\n        const itemWentDarkAlerts = this.props.shrinkageAlerts.itemWentDarkAlerts;\n        const largeQtyWentDarkAlerts = this.props.shrinkageAlerts.largeQuantityWentDarkAlerts;\n        const alerts = inventoryNotOnShelfAlerts\n            .concat(backroomInventoryLowAlerts)\n            .concat(itemSkippedPOSAlerts)\n            .concat(itemWentDarkAlerts)\n            .concat(largeQtyWentDarkAlerts);\n\n        return <div style={{marginLeft: 50}}>\n            <div style={{\n                height: 50,\n                borderBottom: '1px solid #ebedf8',\n                display: 'flex',\n                flexDirection: 'row',\n                alignItems: 'center'\n            }}>\n                <img src={process.env.REACT_APP_BASE_URL + \"/alert.svg\"} alt={\"alert\"} style={{padding: \"0 10px\"}}/> <span>Alerts</span>\n            </div>\n            {\n                alerts.length > 0 ?\n                    <div className={\"alerts\"}>\n                        <ul>\n                            {alerts.length == 1 && <li>There is <b>1</b> active alert</li>}\n                            {alerts.length > 1 && <li>There are <b>{alerts.length}</b> alerts active</li>}\n                        </ul>\n                        <div>\n                            <AlertsTable alerts={alerts}/>\n                        </div>\n                        {/*<table className={\"alerts-table\"}>*/}\n                        {/*    <tr>*/}\n                        {/*        <td>TIMESTAMP</td>*/}\n                        {/*        <td>CATEGORY</td>*/}\n                        {/*        <td>ALERT TYPE</td>*/}\n                        {/*        <td>ITEM ID</td>*/}\n                        {/*        <td>GATEWAY</td>*/}\n                        {/*        <td>DESCRIPTION</td>*/}\n                        {/*    </tr>*/}\n                        {/*    {_.sortBy(alerts, alert => -alert.timestamp.getTime())*/}\n                        {/*        .slice(this.page * this.rowsPerPage, (this.page+1) * this.rowsPerPage)*/}\n                        {/*        .map((alert: IAlert) => <tr>*/}\n                        {/*            <td style={{whiteSpace: \"nowrap\"}}>{alert.timestamp.toDateString()}</td>*/}\n                        {/*            <td style={{whiteSpace: \"nowrap\"}}>{alert.category}</td>*/}\n                        {/*            <td style={{whiteSpace: \"nowrap\"}}>{alert.alertType}</td>*/}\n                        {/*            <td style={{whiteSpace: \"nowrap\"}}>{alert.itemId}</td>*/}\n                        {/*            <td style={{whiteSpace: \"nowrap\"}}>{alert.gatewayId}</td>*/}\n                        {/*            <td style={{width: \"100%\"}}>{*/}\n                        {/*                alert.alertType == 'Repeated Scan' ?*/}\n                        {/*                    <span> Item was scanned twice at location <i>{(alert as IRepeatedScanAlert).location}</i> (previous scan was at {(alert as IRepeatedScanAlert).prevTime.toDateString()})</span>*/}\n                        {/*                    : alert.alertType == 'Too Many Scans' ?*/}\n                        {/*                    <span> Item was scanned <b>{(alert as ITooManyScansAlert).count}</b> times</span>*/}\n                        {/*                    : alert.alertType == 'Adjacent Scans' ?*/}\n                        {/*                        <span> Detected two consecutive scans in different locations in under <b>{Math.ceil((alert as IAdjacentScansAlert).deltaInMs / 1000 / 60)}</b> minutes.</span>*/}\n                        {/*                        : alert.alertType == 'Inventory Not On Shelf' ?*/}\n                        {/*                            <span>Customer shelf contains less than 3 items.</span>*/}\n                        {/*                            : alert.alertType == 'Backroom Inventory Low' ?*/}\n                        {/*                                <span>Customer backroom is empty.</span>*/}\n                        {/*                                : alert.alertType == 'Item Skipped POS' ?*/}\n                        {/*                                    <span>Item went from shelf to front door, skipped point-of-sale.</span>*/}\n                        {/*                                    : alert.alertType == 'Item Went Dark' ?*/}\n                        {/*                                        <span>On-shelf item did not scan for more than {Math.floor((Date.now() - alert.timestamp.getTime()) / 60 / 60 / 1000)} hours.</span>*/}\n                        {/*                                        : alert.alertType == 'Large Quantity Went Dark' ?*/}\n                        {/*                                            <span> <b>{(alert as ILargeQuantityWentDarkAlert).quantity}</b> items went dark.</span>*/}\n                        {/*                                            :*/}\n                        {/*                                            <span></span>*/}\n                        {/*            }</td>`*/}\n                        {/*        </tr>)}*/}\n                        {/*</table>*/}\n                        {/*<TablePagination*/}\n                        {/*    rowsPerPageOptions={[5, 10]}*/}\n                        {/*    component=\"div\"*/}\n                        {/*    count={alerts.length}*/}\n                        {/*    rowsPerPage={this.rowsPerPage}*/}\n                        {/*    page={this.page}*/}\n                        {/*    onChangePage={(e, page) => this.page = page}*/}\n                        {/*    onChangeRowsPerPage={(e) => {*/}\n                        {/*        this.rowsPerPage = parseInt(e.target.value)*/}\n                        {/*    }}*/}\n                        {/*/>*/}\n                    </div>\n                    : <div style={{color: '#bebebe', margin: 10}}>- None -</div>\n            }\n\n        </div>\n    }\n\n    private renderDataSection() {\n        const {statistics} = this.props;\n        return <div style={{\n            width: '100%',\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'center',\n            justifyContent: 'center'\n        }}>\n            <div className={\"title\"} style={{\n                height: 96,\n                width: '100%',\n                borderBottom: '1px solid #ebedf8',\n            }}><span style={{marginTop: 22}}>Data</span></div>\n            <div style={{margin:\"30px 30px 0 30px\"}}>\n                <table className={'data-table'}>\n                    <tr>\n                        <td className={'border-right border-bottom'}><Databox title={\"Alerted Products\"} data={statistics.alertedItems.length}/></td>\n                        <td className={'border-left border-bottom'}><Databox title={\"Avg. Time in pipeline\"} data={statistics.avgPiplineTimePerItemInDays} subText={\"DAYS\"} decimals={1}/></td>\n                    </tr>\n                    <tr>\n                        <td className={'border-right border-top'}><Databox title={\"Suspected counterfeit\"} data={0}/></td>\n                        <td className={'border-left border-top'}><Databox title={\"Avg. scans per item\"} data={statistics.avgRecordsPerItem} decimals={1}/></td>\n                    </tr>\n                </table>\n                <div style={{\n                    borderBottom: \"1px solid #ebedf8\",\n                    height: 0\n                }}/>\n                <div style={{\n                    fontSize: 16,\n                    color: '#060606',\n                    margin: '40px 0 40px'\n                }}>\n                    Items Location\n                </div>\n                <img src={process.env.REACT_APP_BASE_URL + \"/worldmap.svg\"} style={{width: '100%'}} alt=\"Route tracking\"/>\n            </div>\n        </div>\n    }\n}\n","import * as _ from \"lodash\";\nimport {computed} from \"mobx\";\nimport {ScanRecord} from \"./record\";\nimport {Statistics} from \"./statistics\";\nimport {GatewayConfig} from \"./gateway-config\";\nimport {RecordStore} from \"./record-store\";\n\nexport class OSAStats {\n\n    constructor(private gatewayId: string, private records: RecordStore, private statistics: Statistics, private gatewayConfig: GatewayConfig) {}\n\n    @computed get itemCountAtGateway(): number {\n        return this.statistics.itemCountByGateway(this.gatewayId);\n    }\n\n    @computed get itemCountAtBackroom(): number {\n        return this.statistics.itemCountByGateway(this.gatewayConfig.getFor(this.gatewayId).BackroomGatewayId);\n    }\n\n    @computed get turnoverTimes(): {[itemId: string]: number} {\n        const lastItemScan: {[itemId: string]: ScanRecord} = {};\n        const turnoverTimes:  {[itemId: string]: number} = {};\n\n        for (const rec of this.records.records) {\n            const prev = lastItemScan[rec.itemId()];\n            if (prev && prev.gatewayId().toLowerCase() == this.gatewayId.toLowerCase()) {\n                if (rec.gatewayId().toLowerCase() != this.gatewayId.toLowerCase()) {\n                    turnoverTimes[rec.itemId()] = rec.timestampInMilliseconds() - prev.timestampInMilliseconds();\n                }\n            } else {\n                lastItemScan[rec.itemId()] = rec;\n            }\n        }\n\n        return turnoverTimes;\n    }\n\n    @computed get avgTurnoverTime(): number {\n        const times = this.turnoverTimes;\n        return Object.keys(times).length > 0 ? _.mean(_.values(times)) : 0;\n    }\n\n    turnoverTimeHistogram(nBins: number): {bins: number[], binSize: number} {\n        const times = _.values(this.turnoverTimes);\n        const bins = _.range(nBins).map(() => 0);\n        const binSize = (_.max(times) + 1) / nBins;\n\n        for (const t of times) {\n            bins[Math.floor(t / binSize)]++;\n        }\n\n        return {bins, binSize};\n    }\n\n    itemCountHistory(gatewayId: string): Array<{time: number, count: number}> {\n        const itemLoc: {[itemId: string]: string} = {};\n        const history: Array<{time: number, count: number}> = [];\n        let count = 0;\n\n        for (const rec of this.records.records) {\n            const prev = itemLoc[rec.itemId()];\n            const current = rec.gatewayId();\n            if (prev && prev.toLowerCase() == gatewayId.toLowerCase()) {\n                if (current.toLowerCase() != this.gatewayId.toLowerCase()) {\n                    count--;\n                    history.push({time: rec.timestampInMilliseconds(), count});\n                }\n            } else if (current.toLowerCase() == this.gatewayId.toLowerCase()){\n                count++;\n                history.push({time: rec.timestampInMilliseconds(), count});\n            }\n            itemLoc[rec.itemId()] = rec.gatewayId();\n        }\n\n        return history;\n    }\n\n    @computed get gatewayItemCountHistory(): Array<{time: number, count: number}> {\n        return this.itemCountHistory(this.gatewayId);\n    }\n\n    @computed get backroomItemCountHistory(): Array<{time: number, count: number}> {\n        const backroomId = this.gatewayConfig.getFor(this.gatewayId).BackroomGatewayId;\n        if (backroomId) {\n            return this.itemCountHistory(backroomId);\n        } else {\n            return [];\n        }\n    }\n}\n\n\n","import React from \"react\";\nimport {Alert, AlertTitle} from \"@material-ui/lab\";\n\n\nexport class ErrorPage extends React.Component<{err: Error}, {}> {\n\n    render() {\n        return <div style={{display: 'flex', alignItems: 'center', justifyContent: 'center', height: '100%', textAlign: 'left'}}>\n            <Alert severity=\"error\">\n                <AlertTitle>Error</AlertTitle>\n                We were unable to load the page at the moment. Please try again. <br/>\n                <span style={{color: \"#bebebe\"}}><pre>{this.props.err.toString()}</pre></span>\n            </Alert>\n        </div>\n    }\n\n}\n","import React from \"react\";\nimport * as _ from \"lodash\";\nimport {inject, observer} from \"mobx-react\";\nimport {Statistics} from \"./statistics\";\nimport {observable, reaction} from \"mobx\";\nimport {Button, CircularProgress, DialogTitle, TablePagination, TextField} from \"@material-ui/core\";\nimport {Autocomplete, createFilterOptions} from \"@material-ui/lab\";\nimport {gatewayImage, partnerBrandImage, stageImage} from \"./resources\";\nimport {ScanRecord, stagesDisplay} from \"./record\";\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\nimport AccountCircleOutlinedIcon from '@material-ui/icons/AccountCircleOutlined';\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport {GatewayConfig, IGatewayConfigRecord} from \"./gateway-config\";\nimport {OSAStats} from \"./osa-stats\";\nimport {RecordStore} from \"./record-store\";\nimport {BarChart} from \"./bar-chart\";\nimport {ErrorPage} from \"./error-page\";\nimport {Bar, Line} from 'react-chartjs-2';\nimport moment from \"moment\";\nimport {PageHeader} from \"./page-header\";\nimport {AlertsTable} from \"./alerts-table\";\nimport {OSAAlerts} from \"./osa-alerts\";\n\nconst twodigits = (n:number) => (n < 10 ? '0' : '') + n.toString();\n\nconst prettyFloat = (f: number) => `${Math.floor(f*10)/10}`;\n\nconst formatTurnoverTime = (tMs: number): string => {\n    const MINUTE_MS = 60*1000;\n    const HOUR_MS = 60*MINUTE_MS;\n    const DAY_MS = 24*HOUR_MS;\n    if (tMs < HOUR_MS) {\n        const minutes = tMs / MINUTE_MS;\n        return `${prettyFloat(minutes)} Minutes`\n    }\n    if (tMs < DAY_MS) {\n        const hours = tMs / HOUR_MS;\n        return `${prettyFloat(hours)} Hours`\n    }\n\n    const days = tMs / DAY_MS;\n    return `${prettyFloat(days)} Days`\n\n};\n\n@inject(\"statistics\", \"gatewayConfig\", \"records\", \"osaAlerts\")\n@observer\nexport class OnShelfAvailabilityPage extends React.Component<{statistics: Statistics, gatewayConfig: GatewayConfig, records: RecordStore, osaAlerts: OSAAlerts}, {}> {\n\n    @observable private ready = false;\n    private currentTimeoutHandle;\n\n    @observable selectedGatewayId: string;\n    @observable osaStats: OSAStats;\n\n    componentDidMount() {\n        const first = this.props.gatewayConfig.customerRetailShelves[0];\n        if (first) {\n            this.selectedGatewayId = first.ID;\n        }\n        this.loadData();\n    }\n\n    loadData() {\n        const gatewayId = this.selectedGatewayId;\n        if (this.props.gatewayConfig.getFor(gatewayId) == null) {\n            return;\n        }\n\n        this.ready = false;\n        if (this.currentTimeoutHandle) {\n            clearTimeout(this.currentTimeoutHandle);\n        }\n        this.currentTimeoutHandle = setTimeout(() => {\n            this.ready = true;\n            this.currentTimeoutHandle = null;\n            this.osaStats = new OSAStats(gatewayId, this.props.records, this.props.statistics, this.props.gatewayConfig);\n        }, 1000);\n    }\n\n    componentWillUnmount() {\n        if (this.currentTimeoutHandle) {\n            clearTimeout(this.currentTimeoutHandle);\n        }\n    }\n\n    render() {\n        if (this.props.gatewayConfig.customerRetailShelves.length == 0) {\n            return <ErrorPage err={new Error(\"Gateway config does not appear to contain a shelf gateway. Please make sure there is at least one gateway with LocationType set to 'Customer Retail Shelf', and that the gateway is configured with a BackroomGatewayID. \")}/>\n        }\n        const turnoverTimeHistogram = this.osaStats ? this.osaStats.turnoverTimeHistogram(10) : null;\n        return <div>\n            <PageHeader title={\"OSA Dashboard\"}/>\n            {!this.ready ?\n                <div style={{padding: 10}}><CircularProgress/></div>\n            : <div style={{width: 1200}}>\n                <div style={{margin: \"0 0 30px 30px\"}}>\n                <div style={{display: 'flex', alignItems: 'center'}}>\n                    <div style={{\n                        fontWeight: 'bold',\n                        fontSize: 21,\n                        padding: '32px 15px 32px 0'\n                    }}>Select a shelf gateway:</div>\n                    <Autocomplete\n                        options={this.props.gatewayConfig.customerRetailShelves.map(c => c.ID)}\n                        getOptionLabel={(gwId) => {\n                            const cfg = this.props.gatewayConfig.getFor(gwId);\n                            return `${cfg.ID} ${ cfg.Alias ? `- ${cfg.Alias}` : ''}`;\n                        }}\n                        style={{width: 600}}\n                        onChange={(e, value) => {\n                            this.selectedGatewayId = value;\n                            this.loadData();\n                        }}\n                        value={this.selectedGatewayId}\n                        renderInput={params => <TextField {...params} label=\"Gateway ID\" variant=\"outlined\" />}\n                    />\n                    {!this.ready && <CircularProgress style={{marginLeft: 20}}/>}\n                </div>\n                { this.osaStats && <div>\n                    <div style={{display: 'flex', flexDirection: 'row', paddingBottom: 20, borderBottom: '1px solid grey'}}>\n                        <div style={{borderRight: \"1px solid grey\"}}>\n                            {this.metricBox(\"ITEMS ON SHELF\", \"#1d6aac\", process.env.REACT_APP_BASE_URL + '/inventory.svg', this.osaStats.itemCountAtGateway)}\n                            {this.metricBox(\"ITEMS IN STOREROOM\", \"#008a91\", process.env.REACT_APP_BASE_URL + '/mixingcenter.svg', this.osaStats.itemCountAtBackroom)}\n                        </div>\n                        <div style={{flex: 1, padding: \"0 10px\"}}>\n                            <div style={{width: 800}}>\n                                <Line\n                                    data={{\n                                        // labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'],\n                                        datasets: [\n                                            {\n                                                label: 'Shelf Item Count',\n                                                fill: false,\n                                                lineTension: 0.1,\n                                                backgroundColor: 'rgba(75,192,192,0.4)',\n                                                borderColor: 'rgba(75,192,192,1)',\n                                                borderCapStyle: 'butt',\n                                                borderDash: [],\n                                                borderDashOffset: 0.0,\n                                                borderJoinStyle: 'miter',\n                                                pointBorderColor: 'rgba(75,192,192,1)',\n                                                pointBackgroundColor: '#fff',\n                                                pointBorderWidth: 1,\n                                                pointHoverRadius: 5,\n                                                pointHoverBackgroundColor: 'rgba(75,192,192,1)',\n                                                pointHoverBorderColor: 'rgba(220,220,220,1)',\n                                                pointHoverBorderWidth: 2,\n                                                pointRadius: 1,\n                                                pointHitRadius: 10,\n                                                data: this.osaStats.gatewayItemCountHistory.map(x => ({t: x.time, y: x.count}))\n                                            },\n                                            {\n                                                label: 'Storeroom Item Count',\n                                                fill: false,\n                                                lineTension: 0.1,\n                                                backgroundColor: 'rgba(75,0,192,0.4)',\n                                                borderColor: 'rgba(75,0,192,1)',\n                                                borderCapStyle: 'butt',\n                                                borderDash: [],\n                                                borderDashOffset: 0.0,\n                                                borderJoinStyle: 'miter',\n                                                pointBorderColor: 'rgba(75,0,192,1)',\n                                                pointBackgroundColor: '#fff',\n                                                pointBorderWidth: 1,\n                                                pointHoverRadius: 5,\n                                                pointHoverBackgroundColor: 'rgba(75,0,192,1)',\n                                                pointHoverBorderColor: 'rgba(220,0,220,1)',\n                                                pointHoverBorderWidth: 2,\n                                                pointRadius: 1,\n                                                pointHitRadius: 10,\n                                                data: this.osaStats.backroomItemCountHistory.map(x => ({t: new Date(x.time), y: x.count}))\n                                            },\n                                        ]\n                                    }}\n                                  width={800}\n                                  height={300}\n                                  options={{\n                                      scales: {\n                                          xAxes: [{\n                                              type: 'time',\n                                              distribution: 'linear',\n                                              offset: true,\n                                              // ticks: {\n                                              //     major: {\n                                              //         enabled: true,\n                                              //         fontStyle: 'bold'\n                                              //     },\n                                              //     source: 'data',\n                                              //     autoSkip: true,\n                                              //     autoSkipPadding: 75,\n                                              //     // maxRotation: 0,\n                                              //     sampleSize: 100\n                                              // },\n                                              // afterBuildTicks: function(scale: any, ticks: any) {\n                                              //     var majorUnit = scale._majorUnit;\n                                              //     var firstTick = ticks[0];\n                                              //     var i, ilen, val, tick, currMajor, lastMajor;\n                                              //\n                                              //     val = moment(ticks[0].value);\n                                              //     if ((majorUnit === 'minute' && val.second() === 0)\n                                              //         || (majorUnit === 'hour' && val.minute() === 0)\n                                              //         || (majorUnit === 'day' && val.hour() === 9)\n                                              //         || (majorUnit === 'month' && val.date() <= 3 && val.isoWeekday() === 1)\n                                              //         || (majorUnit === 'year' && val.month() === 0)) {\n                                              //         firstTick.major = true;\n                                              //     } else {\n                                              //         firstTick.major = false;\n                                              //     }\n                                              //     lastMajor = val.get(majorUnit);\n                                              //\n                                              //     for (i = 1, ilen = ticks.length; i < ilen; i++) {\n                                              //         tick = ticks[i];\n                                              //         val = moment(tick.value);\n                                              //         currMajor = val.get(majorUnit);\n                                              //         tick.major = currMajor !== lastMajor;\n                                              //         lastMajor = currMajor;\n                                              //     }\n                                              //     return ticks;\n                                              // }\n                                          }],\n                                          yAxes: [{\n                                              ticks: {\n                                                  beginAtZero:true\n                                              }\n                                          }]\n                                      },\n                                      maintainAspectRatio: false,\n                                      legend: {display: true}\n                                  }}\n                                />\n                            </div>\n                        </div>\n                    </div>\n                    <div style={{display: 'flex', flexDirection: 'row', paddingTop: 20}}>\n                        <div style={{padding: \"0 10px\", borderRight: \"1px solid grey\"}}>\n                            <div style={{width: 300, backgroundColor: \"#f8f8f8\", margin: \"50px 0\"}}>\n                                <div style={{textAlign: \"center\", padding: 20, fontWeight: 900, letterSpacing: '1.07px'}}>AVG TURNOVER TIME</div>\n                                <div style={{textAlign: \"center\", padding: \"40px 60px 60px 60px\", fontWeight: 'bold', fontSize: 30}}>{formatTurnoverTime(this.osaStats.avgTurnoverTime)}</div>\n                            </div>\n                        </div>\n                        <div style={{padding: \"0 10px\", width: 800, height: 300}}>\n                            <div style={{textAlign: 'center', fontWeight: 'bold'}}>TURNOVER TIME (histogram)</div>\n                            {/*<BarChart labels={_.range(10).map(s => s.toString())} values={this.osaStats.turnoverTimeHistogram(10).bins} colors={[\"black\"]} images={[]}/>*/}\n                            <Bar\n                                data={{\n                                    labels: _.range(turnoverTimeHistogram.bins.length).map((s, i) => '<'+formatTurnoverTime((i + 1)*turnoverTimeHistogram.binSize)),\n                                    datasets: [\n                                        {\n                                            label: 'Turnover Time',\n                                            backgroundColor: 'rgba(255,99,132,0.2)',\n                                            borderColor: 'rgba(255,99,132,1)',\n                                            borderWidth: 1,\n                                            hoverBackgroundColor: 'rgba(255,99,132,0.4)',\n                                            hoverBorderColor: 'rgba(255,99,132,1)',\n                                            data: turnoverTimeHistogram.bins\n                                        }\n                                    ]\n                                }}\n                                width={800}\n                                height={200}\n                                options={{\n                                    maintainAspectRatio: false,\n                                    legend: {display: false},\n                                    scales: {\n                                        yAxes: [{\n                                            ticks: {\n                                                beginAtZero:true\n                                            }\n                                        }]\n                                    }\n                                }}\n                            />\n                        </div>\n                    </div>\n                </div> }\n                </div>\n                <div style={{margin: \"0 0 20px 20px\", fontWeight: 'bold'}}> OSA Alerts </div>\n                <AlertsTable alerts={this.props.osaAlerts.alerts}/>\n            </div>}\n        </div>\n    }\n\n    metricBox(title: string, color: string, iconUrl: string, count: number, style={}) {\n        return <div style={{width: 300, padding: 10, letterSpacing: \"1.07px\", ...style}}>\n            <div style={{backgroundColor: color, padding: 10, color: \"white\"}}>\n                <img src={iconUrl} style={{verticalAlign: \"middle\", paddingRight: 20, width: 30}}/>\n                <span style={{verticalAlign: \"middle\", fontSize: \"0.8em\"}}>{title}</span>\n            </div>\n            <div style={{\n                backgroundColor: \"#f8f8f8\",\n                textAlign: \"center\",\n                padding: \"20px 0\",\n                fontWeight: \"bold\",\n                fontSize: 30\n            }}>{count}</div>\n        </div>\n    }\n\n}\n","import {ItemStatusPage} from \"./item-status-page\";\nimport {OverviewPage} from \"./overview-page\";\nimport {OnShelfAvailabilityPage} from \"./on-shelf-availability-page\";\nimport {ShrinkagePage} from \"./shrinkage-page\";\n\ntype RouteName = \"itemStatus\" | \"overview\" | \"onShelfAvailability\" | \"shrinkage\";\n\nexport interface IRoute {\n  name: RouteName;\n  displayIndex: number;\n  cssClass: string;\n  path: string,\n  menuImg: string\n  component;\n}\n\nexport const routes: IRoute[] = [\n  {\n    name: 'shrinkage',\n    path: '/shrinkage',\n    menuImg: '/menu-item-shrinkage.svg',\n    cssClass: 'osa',\n    displayIndex: 3,\n    component: ShrinkagePage\n  },\n  {\n    name: 'onShelfAvailability',\n    path: '/osa',\n    menuImg: '/menu-item-osa.svg',\n    cssClass: 'osa',\n    displayIndex: 2,\n    component: OnShelfAvailabilityPage\n  },\n  {\n    name: 'itemStatus',\n    path: '/item_status',\n    menuImg: '/menu-item-status.svg',\n    cssClass: 'item-status',\n    displayIndex: 1,\n    component: ItemStatusPage\n  },\n  { // must be last\n    name: 'overview',\n    path: '/',\n    menuImg: '/menu-overview.svg',\n    cssClass: 'overview',\n    displayIndex: 0,\n    component: OverviewPage\n  }\n];\n\n\nexport function getCurrentRoute(): IRoute {\n  return routes.find(r => r.path == window.location.hash.slice(1)) || routes[routes.length - 1];\n}\n\nexport function getRoute(name: RouteName): IRoute {\n  return routes.find(r => r.name == name);\n}\n","import React from \"react\";\nimport * as _ from \"lodash\";\nimport {inject, observer} from \"mobx-react\";\nimport {Statistics} from \"./statistics\";\nimport {observable, reaction} from \"mobx\";\nimport {GatewayConfig, IGatewayConfigRecord} from \"./gateway-config\";\nimport {RecordStore} from \"./record-store\";\nimport {ErrorPage} from \"./error-page\";\nimport {Line} from \"react-chartjs-2\";\nimport {ShrinkageAlerts} from \"./shrinkage-alerts\";\nimport {alertsByTime} from \"./alerts\";\nimport {PageHeader} from \"./page-header\";\nimport {AlertsTable} from \"./alerts-table\";\nimport {CircularProgress} from \"@material-ui/core\";\n\n@inject(\"statistics\", \"gatewayConfig\", \"records\", \"shrinkageAlerts\")\n@observer\nexport class ShrinkagePage extends React.Component<{statistics: Statistics, gatewayConfig: GatewayConfig, records: RecordStore, shrinkageAlerts: ShrinkageAlerts}, {}> {\n\n    @observable private ready = false;\n    private currentTimeoutHandle;\n\n    componentDidMount() {\n        this.loadData();\n    }\n\n    loadData() {\n        this.ready = false;\n        if (this.currentTimeoutHandle) {\n            clearTimeout(this.currentTimeoutHandle);\n        }\n        this.currentTimeoutHandle = setTimeout(() => {\n            this.ready = true;\n            this.currentTimeoutHandle = null;\n        }, 1000);\n    }\n\n    componentWillUnmount() {\n        if (this.currentTimeoutHandle) {\n            clearTimeout(this.currentTimeoutHandle);\n        }\n    }\n\n    render() {\n        if (this.props.gatewayConfig.all().length == 0) {\n            return <ErrorPage err={new Error(\"Gateway config appears to be empty. The shrinkage dashboard required a gateway config.\")}/>\n        }\n\n        const itemWentDarkAlertsByTime = alertsByTime(this.props.shrinkageAlerts.itemWentDarkAlerts, 30, 24*60*60*1000);\n        const itemSkippedPOSAlertsByTime = alertsByTime(this.props.shrinkageAlerts.itemSkippedPOSAlerts, 30, 24*60*60*1000);\n\n        return <div>\n            <PageHeader title={\"Shrinkage Dashboard\"}/>\n            {!this.ready ? <div style={{padding: 10}}><CircularProgress/></div> : <div style={{paddingLeft: 10, width: 1000}}>\n                <div style={{display: 'flex', flexDirection: 'row', width: \"100%\", justifyContent: 'center'}}>\n                    {this.metricBox(\"SUSPECTED STOLEN ITEMS\", \"PAST 24H\", this.props.shrinkageAlerts.alertedItemsCountLast24Hours, \"#8f5c5c\")}\n                    {this.metricBox(\"SUSPECTED STOLEN ITEMS\", \"PAST 30 DAYS\", this.props.shrinkageAlerts.alertedItemsCountLast30Days, \"#be8b8b\")}\n                </div>\n                <div style={{width: \"100%\", }}>\n                    <Line\n                        data={{\n                            // labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'],\n                            datasets: [\n                                {\n                                    label: 'Item Went Dark',\n                                    fill: false,\n                                    lineTension: 0.1,\n                                    backgroundColor: 'rgba(75,192,192,0.4)',\n                                    borderColor: '#8f5c5c',\n                                    borderCapStyle: 'butt',\n                                    borderDash: [],\n                                    borderDashOffset: 0.0,\n                                    borderJoinStyle: 'miter',\n                                    pointBorderColor: '#8f5c5c',\n                                    pointBackgroundColor: '#fff',\n                                    pointBorderWidth: 1,\n                                    pointHoverRadius: 5,\n                                    pointHoverBackgroundColor: 'rgba(75,192,192,1)',\n                                    pointHoverBorderColor: 'rgba(220,220,220,1)',\n                                    pointHoverBorderWidth: 2,\n                                    pointRadius: 3,\n                                    pointHitRadius: 10,\n                                    data: itemWentDarkAlertsByTime.bins.map((count, i) => ({t: itemWentDarkAlertsByTime.startTime + itemWentDarkAlertsByTime.binSize*i, y: count}))\n                                },\n                                {\n                                    label: 'Item Skipped POS',\n                                    fill: false,\n                                    lineTension: 0.1,\n                                    backgroundColor: 'rgba(75,192,192,0.4)',\n                                    borderColor: '#bbbbbb',\n                                    borderCapStyle: 'butt',\n                                    borderDash: [],\n                                    borderDashOffset: 0.0,\n                                    borderJoinStyle: 'miter',\n                                    pointBorderColor: '#bbbbbb',\n                                    pointBackgroundColor: '#fff',\n                                    pointBorderWidth: 3,\n                                    pointHoverRadius: 5,\n                                    pointHoverBackgroundColor: 'rgba(75,192,192,1)',\n                                    pointHoverBorderColor: 'rgba(220,220,220,1)',\n                                    pointHoverBorderWidth: 2,\n                                    pointRadius: 1,\n                                    pointHitRadius: 10,\n                                    data: itemSkippedPOSAlertsByTime.bins.map((count, i) => ({t: itemSkippedPOSAlertsByTime.startTime + itemSkippedPOSAlertsByTime.binSize*i, y: count}))\n                                },\n                            ]\n                        }}\n                        width={800}\n                        height={300}\n                        options={{\n                            scales: {\n                                xAxes: [{\n                                    type: 'time',\n                                    distribution: 'linear',\n                                    offset: true,\n                                    // ticks: {\n                                    //     major: {\n                                    //         enabled: true,\n                                    //         fontStyle: 'bold'\n                                    //     },\n                                    //     source: 'data',\n                                    //     autoSkip: true,\n                                    //     autoSkipPadding: 75,\n                                    //     // maxRotation: 0,\n                                    //     sampleSize: 100\n                                    // },\n                                    // afterBuildTicks: function(scale: any, ticks: any) {\n                                    //     var majorUnit = scale._majorUnit;\n                                    //     var firstTick = ticks[0];\n                                    //     var i, ilen, val, tick, currMajor, lastMajor;\n                                    //\n                                    //     val = moment(ticks[0].value);\n                                    //     if ((majorUnit === 'minute' && val.second() === 0)\n                                    //         || (majorUnit === 'hour' && val.minute() === 0)\n                                    //         || (majorUnit === 'day' && val.hour() === 9)\n                                    //         || (majorUnit === 'month' && val.date() <= 3 && val.isoWeekday() === 1)\n                                    //         || (majorUnit === 'year' && val.month() === 0)) {\n                                    //         firstTick.major = true;\n                                    //     } else {\n                                    //         firstTick.major = false;\n                                    //     }\n                                    //     lastMajor = val.get(majorUnit);\n                                    //\n                                    //     for (i = 1, ilen = ticks.length; i < ilen; i++) {\n                                    //         tick = ticks[i];\n                                    //         val = moment(tick.value);\n                                    //         currMajor = val.get(majorUnit);\n                                    //         tick.major = currMajor !== lastMajor;\n                                    //         lastMajor = currMajor;\n                                    //     }\n                                    //     return ticks;\n                                    // }\n                                }],\n                                yAxes: [{\n                                    ticks: {\n                                        beginAtZero:true\n                                    }\n                                }]\n                            },\n                            maintainAspectRatio: false,\n                            legend: {display: true}\n                        }}\n                    />\n                </div>\n                <div style={{margin: \"20px 0 20px 20px\", fontWeight: 'bold'}}> Shrinkage Alerts </div>\n                <AlertsTable alerts={this.props.shrinkageAlerts.alerts}/>\n            </div>}\n        </div>\n    }\n\n    metricBox(title: string, subTitle: string, value: number, color: string) {\n        return <div style={{width: 300, textAlign: 'center', color: \"white\", letterSpacing: 1.07, fontSize: 12, padding: 15}}>\n            <div style={{padding: 10, backgroundColor: color}}>{title}</div>\n            <div style={{backgroundColor: \"#f8f8f8\", color: \"#3d3d3d\"}}>\n                <div style={{padding: \"15px 0 0 0\"}}>{subTitle}</div>\n                <div style={{padding: \"15px 0 25px 0\", fontWeight: \"bold\", fontSize: 25}}>{value}</div>\n            </div>\n        </div>\n    }\n}\n","import * as _ from 'lodash';\n\nimport React from \"react\";\nimport {getCurrentRoute, IRoute, routes} from \"./routes\";\nimport {observer} from \"mobx-react\";\nimport {observable} from \"mobx\";\n\nfunction Link({onClick, className}) {\n    return <div onClick={() => onClick()} style={{width: '100%', boxSizing: 'border-box', margin: 30}} className={className}/>;\n}\n\n@observer\nexport class SideMenu extends React.Component<{},{}> {\n\n    @observable currentRoute = getCurrentRoute();\n\n    render() {\n        const className = (route: IRoute) => {\n            return `menu-item menu-item-${route.cssClass} ${this.currentRoute.name == route.name ? 'selected' : ''}`\n        };\n\n        return <div className=\"side-menu\" style={{height: '100%', width: '100%'}}>\n            <style dangerouslySetInnerHTML={{__html:`\n                .side-menu .menu-item-overview {\n                    background-image: url(${process.env.REACT_APP_BASE_URL}/menu-overview.svg);\n                }\n\n                .side-menu .menu-item-overview.selected{\n                    background-image: url(${process.env.REACT_APP_BASE_URL}/menu-overview-selected.svg);\n                    border-right: 3px solid #3e4d73;\n                }\n\n                .side-menu .menu-item-overview:hover{\n                    background-image: url(${process.env.REACT_APP_BASE_URL}/menu-overview-hovered.svg);\n                }\n\n                .side-menu .menu-item-item-status {\n                    background-image: url(${process.env.REACT_APP_BASE_URL}/menu-item-status.svg);\n                }\n\n                .side-menu .menu-item-item-status.selected{\n                    background-image: url(${process.env.REACT_APP_BASE_URL}/menu-item-status-selected.svg);\n                    border-right: 3px solid #3e4d73;\n                }\n\n                .side-menu .menu-item-item-status:hover{\n                    background-image: url(${process.env.REACT_APP_BASE_URL}/menu-item-status-hovered.svg);\n                }\n\n                .side-menu .menu-item-osa {\n                    background-image: url(${process.env.REACT_APP_BASE_URL}/menu-item-osa.svg);\n                }\n\n                .side-menu .menu-item-osa.selected {\n                    background-image: url(${process.env.REACT_APP_BASE_URL}/menu-item-osa-selected.svg);\n                    border-right: 3px solid #3e4d73;\n                }\n\n                .side-menu .menu-item-osa:hover {\n                    background-image: url(${process.env.REACT_APP_BASE_URL}/menu-item-status-hovered.svg);\n                }\n            `}}/>\n            <div className='side-menu-orbs' style={{padding: 30, marginBottom: 20}}>\n                <img style={{height: 32, width:32}} src={process.env.REACT_APP_BASE_URL + '/orbs-logo.svg'}/>\n            </div>\n            {\n                _.sortBy(routes, r => r.displayIndex).map(\n                    route => <Link\n                        onClick={() => this.navigateTo(route)}\n                        className={className(route)}\n                    />\n                )\n            }\n        </div>\n    }\n\n    navigateTo(route: IRoute) {\n        window.location.hash = route.path;\n        this.currentRoute = route;\n    }\n\n    componentDidMount(): void {\n        window.onhashchange = () => this.currentRoute = getCurrentRoute();\n    }\n\n    componentWillUnmount(): void {\n        window.onhashchange = null;\n    }\n}\n","import React from \"react\";\nimport * as _ from \"lodash\";\nimport {observer} from \"mobx-react\";\nimport {observable} from \"mobx\";\n\n@observer\nexport class LoadingPage extends React.Component<{}, {}> {\n\n    @observable loadingCaption = \"Loading...\";\n\n    render() {\n        return <div className={\"loading-page\"}>\n            <div className={\"logo-container\"}>\n                <div style={{\n                    height: '100%',\n                    width: '100%',\n                    textAlign: 'center'\n                }}><img className={\"orbs-logo\"} src={process.env.REACT_APP_BASE_URL + \"/orbs-logo.svg\"}/></div>\n                <div className={\"loading-lbl\"}>{this.loadingCaption}</div>\n            </div>\n        </div>\n    }\n\n    componentDidMount() {\n        let i = 0;\n        setInterval(() => {\n            this.loadingCaption = \"Loading\" + _.range(i).map(() => '.').join('');\n            i = (i + 1) % 4;\n        }, 500)\n    }\n}\n","import * as _ from 'lodash';\nimport React from 'react';\nimport {inject, observer} from \"mobx-react\";\nimport {RecordStore} from \"./record-store\";\nimport {BrowserRouter, Switch, Route, HashRouter} from 'react-router-dom';\nimport {routes} from \"./routes\";\nimport {SideMenu} from \"./side-menu\";\nimport {LoadingPage} from \"./loading-page\";\nimport {ErrorPage} from \"./error-page\";\nimport {GatewayConfig} from \"./gateway-config\";\n\n\n@inject('records', 'gatewayConfig')\n@observer\nexport class App extends React.Component<{\n  records?: RecordStore\n  gatewayConfig?: GatewayConfig\n},{}> {\n  render() {\n    return this.props.records.ready && this.props.gatewayConfig.ready ? <HashRouter>\n      <div style={{height: '100%', width: '100%', maxWidth: 2000, display: \"inline-block\", position: 'relative', textAlign: 'left'}}>\n        <div style={{position: 'absolute', top: 0, left: 0, bottom: 0, width: 89}}>\n          <SideMenu/>\n        </div>\n        <div style={{position: 'absolute', top: 0, left: 90, bottom: 0, right:0, overflow: 'auto', borderRight: \"1px solid #ebedf8\"}}>\n            <Switch>\n              {\n                routes.map(route => {\n                  const PageComponent = route.component;\n                  return <Route path={route.path}>\n                    <PageComponent/>\n                  </Route>\n                })\n              }\n            </Switch>\n        </div>\n      </div>\n    </HashRouter>\n            : this.props.records.err || this.props.gatewayConfig.err ? <ErrorPage err={this.props.records.err || this.props.gatewayConfig.err}/>\n            : <LoadingPage/>\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport * as serviceWorker from './serviceWorker';\nimport {Provider} from \"mobx-react\";\nimport {createStores} from \"./stores\";\nimport {App} from \"./App\";\n\nconst stores = createStores();\n(window as any).stores = stores;\n\nReactDOM.render(\n    <Provider {...stores}>\n        <App/>\n    </Provider>\n    ,document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n\n","import {RecordStore} from \"./record-store\";\nimport {Statistics} from \"./statistics\";\nimport {GatewayConfig} from \"./gateway-config\";\nimport {OSAAlerts} from \"./osa-alerts\";\nimport {ShrinkageAlerts} from \"./shrinkage-alerts\";\n\nexport interface IStores {\n    records: RecordStore;\n    statistics: Statistics;\n    gatewayConfig: GatewayConfig;\n    osaAlerts: OSAAlerts;\n    shrinkageAlerts: ShrinkageAlerts;\n}\n\nexport function createStores(): IStores {\n    const gatewayConfig = new GatewayConfig();\n    const records = new RecordStore(gatewayConfig);\n    const statistics = new Statistics(records);\n    const osaAlerts = new OSAAlerts(statistics, gatewayConfig);\n    const shrinkageAlerts = new ShrinkageAlerts(statistics, gatewayConfig);\n    return {\n        records,\n        gatewayConfig,\n        statistics,\n        osaAlerts,\n        shrinkageAlerts\n    }\n}\n"],"sourceRoot":""}